<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Nested Y.Apps Spike</title>
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.2.1/pure-min.css">
</head>
<body>
	<script src="/yui3/build/yui/yui-min.js"></script>
	<script src="/static/yui_config.js"></script>
	<script>
		YUI({
			filter: 'raw'
		}).use('router', 'top-app', function(Y) {
			'use strict';

			var location = Y.config.win.location,
				rootPath = '/top/',
				app;

			// TODO: Find a more static way to do this so it can be done sooner (in the head?)
			// TODO: Y.Router.html5 is not documented so may be private
			if (!Y.Router.html5 && location.pathname.length > rootPath.length) {
				// If we've ended up with a full path on a browser that doesn't support pushState we reload the page
				// with a hash-based path so that subsequent navigations are correct
				location.replace('/#' + location.pathname);
				return;
			}

			app = new Y.SPIKE.TopApp({
				root: rootPath
			});

			app.render().dispatch();
		});
	</script>
</body>
</html>
